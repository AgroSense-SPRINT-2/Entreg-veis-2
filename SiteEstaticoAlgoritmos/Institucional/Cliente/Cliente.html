  <!DOCTYPE html>
  <html lang="pt-br">

  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>√Årea do Cliente</title>
    <link rel="stylesheet" href="Cliente.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2"></script>
  </head>
  <body>
    <div class="sidebar">
      <div class="usuario">
        <img src="Design_sem_nome-removebg-preview.png" alt="">
        <p>Bem-vindo, <strong>Admin1234</strong></p>
      </div>
      <a href="#">In√≠cio</a>
      <a href="#">Sensores</a>
      <a href="#">Quadrantes</a>
      <a href="../site.html">Sair</a>
    </div>
    <div class="main">
      <section class="cards">
        <button id="menu-toggle" class="menu-btn">‚ò∞</button>
        <div class="card">
          <h3>Lista de Sensores:</h3>
          <div class="sensor-list">
            <div class="sensor-item">
              <span><strong>Sensor 1:</strong> Quadrante A - <span class="ativo">Ativo</span></span>
            </div>
            <div class="sensor-item">
              <span><strong>Sensor 2:</strong> Quadrante B - <span class="inativo">Inativo</span></span>
            </div>
            <div class="sensor-item">
              <span><strong>Sensor 3:</strong> Quadrante D - <span class="inativo">Inativo</span></span>
            </div>
            <div class="sensor-item">
              <span><strong>Sensor 4:</strong> Quadrante C - <span class="ativo">Ativo</span></span>
            </div>
            <div class="sensor-item">
              <span><strong>Sensor 5:</strong> Quadrante E - <span class="ativo">Ativo</span></span>
            </div>
          </div>
        </div>
        <div class="card">
          <h3>Lista de √Åreas:</h3>
          <div class="sensor-list">
            <div class="sensor-item">
              <div>
                <strong>Quadrante A:</strong> Sensor 1
                <br>
                <small>M√°x: 48% | M√≠n: 32%</small>
              </div>
              <span class="ativo">Ideal üü¢</span>
            </div>
          
            <div class="sensor-item">
              <div>
                <strong>Quadrante B:</strong> Sensor 2
                <br>
                <small>M√°x: 98% | M√≠n: 18%</small>
              </div>
              <span class="inativo">Encharcado üåßÔ∏è</span>
            </div>
          
            <div class="sensor-item">
              <div>
                <strong>Quadrante D:</strong> Sensor 3
                <br>
                <small>M√°x: 25% | M√≠n: 12%</small>
              </div>
              <span class="inativo">Seca üö®</span>
            </div>
          
            <div class="sensor-item">
              <div>
                <strong>Quadrante C:</strong> Sensor 4
                <br>
                <small>M√°x: 42% | M√≠n: 28%</small>
              </div>
              <span class="ativo">Ideal üü¢</span>
            </div>
          
            <div class="sensor-item">
              <div>
                <strong>Quadrante E:</strong> Sensor 5
                <br>
                <small>M√°x: 49% | M√≠n: 40%</small>
              </div>
              <span class="ativo">Ideal üü¢</span>
            </div>
          </div>
          
        </div>
        <div class="card card-media">
          <h3>Alertas Recentes</h3>
          <div class="media-content">
            <div class="alertas-recentes">
              <ul class="alert-list">
                <li class="alert-item warning">
                  <span class="time">14:32</span>
                  <span class="icon">üõë</span> 
                  Seca detectada no Quadrante D
                </li>
                <li class="alert-item danger">
                  <span class="time">13:15</span>
                  <span class="icon">‚ö†Ô∏è</span>
                  Encharcamento no Quadrante B
                </li>
                <li class="alert-item success">
                  <span class="time">12:45</span>
                  <span class="icon">‚úÖ</span> 
                  Quadrante E normalizado
                </li>
              </ul>
            </div>
            
          </div>
        </div>
        <div class="card card-media">
          <div class="media-content">
          <h3>Umidade m√©dia dos meses</h3>
          
              <div class="tabela-umidade">
                <div class="card-mes">
                  <h3>Janeiro</h3>
                  <p><strong>Umidade:</strong> 65%</p>
                  <p class="estado-ideal">‚úÖ Ideal</p>
                </div>
              
                <div class="card-mes">
                  <h3>Fevereiro</h3>
                  <p><strong>Umidade:</strong> 32%</p>
                  <p class="estado-baixo">‚ö†Ô∏è Baixa</p>
                </div>
              
                <div class="card-mes">
                  <h3>Mar√ßo</h3>
                  <p><strong>Umidade:</strong> 90%</p>
                  <p class="estado-excesso">üö® Excesso</p>
                </div>
              
                <div class="card-mes">
                  <h3>Abril</h3>
                  <p><strong>Umidade:</strong> 60%</p>
                  <p class="estado-ideal">‚úÖ Ideal</p>
                </div>
              
                <div class="card-mes">
                  <h3>Maio</h3>
                  <p><strong>Umidade:</strong> 38%</p>
                  <p class="estado-baixo">‚ö†Ô∏è Baixa</p>
                </div>
              
                <div class="card-mes">
                  <h3>Junho</h3>
                  <p><strong>Umidade:</strong> 98%</p>
                  <p class="estado-excesso">üö® Excesso</p>
                </div>
              </div>
            </div>
          </div>
        <div class="card">
          <h3>Ultimas sincroniza√ß√µes:</h3>
          <div class="sincronizacoes-diarias">
            <div class="linha-tempo">
              <div class="evento sucesso">
                <div class="ponto">

                </div>
                <div class="conteudo">
                  <h4>26/04/2025</h4>
                  <p>‚úÖ Sincronizado √†s 23:50</p>
                </div>
              </div>
          
              <div class="evento atraso">
                <div class="ponto"></div>
                <div class="conteudo">
                  <h4>25/04/2025</h4>
                  <p>‚ö†Ô∏è Sincronizado com atraso √†s 01:10</p>
                </div>
              </div>
          
              <div class="evento sucesso">
                <div class="ponto"></div>
                <div class="conteudo">
                  <h4>24/04/2025</h4>
                  <p>‚úÖ Sincronizado √†s 23:45</p>
                </div>
              </div>
          
              <div class="evento falha">
                <div class="ponto"></div>
                <div class="conteudo">
                  <h4>23/04/2025</h4>
                  <p>üõë Falha de sincroniza√ß√£o</p>
                </div>
              </div>
            </div>
          </div>
          
        </div>
      </section>
    
        <h2>Gr√°ficos</h2>
        <div class="container-graficos-linha">
          <div class="grafico-item pequeno">
            <h3>Precipita√ß√£o</h3>
            <label for="periodoSelect">Per√≠odo:</label>
            <select id="periodoSelect" onchange="atualizarGraficoPizza()">
              <option value="trimestral">Trimestral</option>
              <option value="semestral">Semestral</option>
            </select>
            <canvas id="graficoPizza"></canvas>
          </div>
      
          <div class="grafico-item medio">
            <h3>Safras perdidas</h3>
            <label for="PeriodoR">Per√≠odo:</label>
            <select id="PeriodoR" name="PeriodoR" onchange="filtro2()">
              <option value="1">Hor√°rios</option>
              <option value="2">Di√°rio</option>
              <option value="3">Mensal</option>
              <option value="4">Semanal</option>
              <option value="5">Semestral</option>
              <option value="6">Trimestral</option>
              <option value="7">Anual</option>

            </select>
            <canvas id="graficoGeral"></canvas>
          </div>
      
          <div class="grafico-item grande">
            <h3>Umidade em (%) </h3>
            <label for="PeriodoL">Per√≠odo:</label>
            <select id="PeriodoL" name="PeriodoL" onchange="filtro()">
              <option value="1">Di√°rio</option>
              <option value="2">Mensal</option>
              <option value="3">Semanal</option>
              <option value="4">Semestral</option>
              <option value="5">Trimestral</option>
              <option value="6">Anual</option>
            </select>
            <canvas id="graficoEspecifico"></canvas>
          </div>
        </div>
  </body>

  </html>
  <script>
    const dadosSafra = {
      1: { // Di√°rio
        labels: ['Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'S√°b', 'Dom'],
        mediaSafra: [150, 100, 170, 100, 120, 50, 220],
        safraIdeal: [210, 300, 400, 199, 500, 140, 600]
      },
      2: { // Mensal
        labels: ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun'],
        mediaSafra: [500, 600, 400, 500, 1000, 850],
        safraIdeal: [1250, 1200, 1350, 1150, 2100, 1300]
      },
      3: { // Semanal
        labels: ['Semana 1', 'Semana 2', 'Semana 3', 'Semana 4'],
        mediaSafra: [220, 150, 190, 280],
        safraIdeal: [320, 320, 320, 320]
      },
      4: { // Semestral
        labels: ['1¬∫ Sem', '2¬∫ Sem'],
        mediaSafra: [2500, 1200],
        safraIdeal: [6100, 6100]
      },
      5: { // Trimestral
        labels: ['1¬∫ Tri', '2¬∫ Tri', '3¬∫ Tri', '4¬∫ Tri'],
        mediaSafra: [1000, 900, 1200, 800],
        safraIdeal: [3200, 3200, 3200, 3200]
      },
      6: { // Anual
        labels: ['2023', '2024'],
        mediaSafra: [12000, 20000],
        safraIdeal: [50000, 100000]
      }
    };
    const dados = {
    1:{ //Hor√°rio
      labels: ['00h', '03h', '06h', '09h', '12h', '15h', '18h', '21h'],
      umidadeMaxima: [55, 50, 48, 32, 55, 44, 40, 30],
      umidadeMinima: [21, 43, 25, 29, 47, 39, 35, 22],
      MaximaIdeal: [60],
      MiminaIdeal: [20],
    },
    2: { // Di√°rio
      labels: ['Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'S√°b', 'Dom'],
      umidadeMaxima: [55, 56, 39, 44, 51, 32, 48],
      umidadeMedia: [60, 62, 59, 63, 58, 55, 61],
      umidadeMinima: [20, 42, 39, 33, 28, 25, 11],
      MaximaIdeal: [60],
      MinimaIdeal: [20],
    },
    3: { // Mensal
      labels: ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun'],
      umidadeMaxima: [56, 55, 50, 20, 35, 45],
      umidadeMedia: [70, 65, 60, 50, 45, 65],
      umidadeMinima: [30, 25, 36, 35, 30, 25],
      MaximaIdeal: [60],
      MinimaIdeal: [20],
    },
    4: { // Semanal
      labels: ['Semana 1', 'Semana 2', 'Semana 3', 'Semana 4'],
      umidadeMaxima: [58, 42, 37, 40],
      umidadeMedia: [68, 62, 67, 60],
      umidadeMinima: [28, 32, 47, 50],
      MaximaIdeal: [60],
      MinimaIdeal: [20],
    },
    5: { // Semestral
      labels: ['1¬∫ Sem', '2¬∫ Sem'],
      umidadeMaxima: [57, 32],
      umidadeMedia: [58, 52],
      umidadeMinima: [38, 22],
      MaximaIdeal: [60],
      MinimaIdeal: [20],
    },
    6: { // Trimestral
      labels: ['1¬∫ Tri', '2¬∫ Tri', '3¬∫ Tri', '4¬∫ Tri'],
      umidadeMaxima: [59, 51, 42, 52],
      umidadeMedia: [59, 51, 50, 52],
      umidadeMinima: [39, 31, 30, 42],
      MaximaIdeal: [60],
      MinimaIdeal: [20],
    },
    7: { // Anual
      labels: ['2023', '2024'],
      umidadeMaxima: [60, 62],
      umidadeMedia: [50, 52],
      umidadeMinima: [40, 42],
      MaximaIdeal: [60],
      MinimaIdeal: [20],
    }
  };

    const ctx1 = document.getElementById('graficoGeral').getContext('2d');
    const grafico = new Chart(ctx1, {
      type: 'bar',
      data: {
        labels: dadosSafra[1].labels,
        datasets: [{
          label: 'Safras perdidas',
          data:  dadosSafra[1].mediaSafra,
          backgroundColor: 'rgb(255, 0, 0)',
          borderColor: 'rgb(255, 0, 0)',
          borderWidth: 1

        }, {
          label: 'Safras plantadas',
          data: dadosSafra[1].safraIdeal,
          backgroundColor: 'rgb(0, 255, 0)',
          borderColor: 'rgb(0, 255, 0)',
          borderWidth: 1
        }
        ]
      },
      options: {
        scales: {
          y: {
            beginAtZero: true
          }
        },
        plugins: {
          legend: {
            display: true,
            position: 'bottom'
          }
        }
      }
    });
    const tge = document.getElementById('graficoEspecifico').getContext('2d');
    const grafico2 = new Chart(tge, {
      type: 'line',
      data: {
        labels: dados[1].labels,
        datasets: [{
          label: 'Maxima (%)',
          data: dados[1].umidadeMaxima,
          backgroundColor: 'rgb(255, 0, 0)',
          borderColor: 'rgb(255, 0, 0)',
          borderWidth: 1

        }, {
          label: 'Media (%)',
          data: dados[1].umidadeMedia,
          backgroundColor: 'rgb(0, 255, 0)',
          borderColor: 'rgb(0, 255, 0)',
          borderWidth: 1
        },
        {
          label: 'Minima (%)',
          data: dados[1].umidadeMinima,
          backgroundColor: 'rgb(0, 0, 255)',
          borderColor: 'rgb(0, 0, 255)',
          borderWidth: 1
        },
        {
          label: 'Umidade Maxima ideal (%)',
          data: new Array(dados[1].labels.length).fill(60),
          backgroundColor: 'rgb(255, 165, 0)',
          borderColor: 'rgb(255, 165, 0)', 
          borderWidth: 1
        }, 
        {
          label: 'Umidade Minima ideal (%)',
          data: new Array(dados[1].labels.length).fill(20),
          backgroundColor: 'rgb(135, 175, 199)',
          borderColor: 'rgb(135,175, 199)',
          borderWidth: 1
        }
        ]
      },
      options: {
        scales: {
          y: {
            beginAtZero: true
          }
        },
        plugins: {
          legend: {
            display: true,
            position: 'bottom'
          }
        }
      }
    });
    function filtro() {
      const periodo = document.getElementById('PeriodoL').value;
      const infoUmidade = dados[periodo];
      if (infoUmidade) 
      {
        grafico2.data.labels = infoUmidade.labels;
        grafico2.data.datasets[0].data = infoUmidade.umidadeMaxima;
        grafico2.data.datasets[1].data = infoUmidade.umidadeMedia;
        grafico2.data.datasets[2].data = infoUmidade.umidadeMinima;
        grafico2.update();

      }
    }
    function filtro2()
    { 
    const periodo = document.getElementById('PeriodoR').value;
    const infoSafra = dadosSafra[periodo];
      if (infoSafra) 
      {
        grafico.data.labels = infoSafra.labels;
        grafico.data.datasets[0].data = infoSafra.mediaSafra;
        grafico.data.datasets[1].data = infoSafra.safraIdeal;
        grafico.update(); 
      }
    }
    // Dados para o gr√°fico de pizza (chuva)
    const dadosChuva = {
      trimestral: [45, 35, 15, 10],
      semestral: [75, 25],
      anual: [100]
    };

    // Fun√ß√£o para gerar labels do gr√°fico de pizza
    function gerarLabelsPizza(periodo) {
      switch (periodo) {
        case 'trimestral':
          return ['Jan-Mar', 'Abr-Jun', 'Jul-Set', 'Out-Dez'];
        case 'semestral':
          return ['Jan-Jun', 'Jul-Dez'];
        default:
          return [];
      }
    }


    // Cria√ß√£o inicial do gr√°fico de pizza
    const ctxPizza = document.getElementById('graficoPizza').getContext('2d');
  let graficoPizza = new Chart(ctxPizza, {
    type: 'pie',
    data: {
      labels: gerarLabelsPizza('trimestral'),
      datasets: [{
        data: dadosChuva.trimestral,
        backgroundColor: [
          '#4e73df', '#1cc88a', '#36b9cc', '#f6c23e',
          '#e74a3b', '#858796', '#5a5c69', '#20c9a6',
          '#fd7e14', '#6610f2', '#6f42c1', '#1e7e34'
        ]
      }]
    },
    options: {
      plugins: {
        legend: {
          position: 'bottom'
        },
        datalabels: {
          color: '#fff', // Cor da porcentagem
          formatter: (value, context) => {
            let total = context.chart.data.datasets[0].data.reduce((a, b) => a + b, 0);
            let percentage = (value / total * 100).toFixed(1) + "%";
            return percentage;
          },
          font: {
            weight: 'bold',
            size: 14
          }
        }
      }
    },
    plugins: [ChartDataLabels] // ATEN√á√ÉO: precisa registrar aqui tamb√©m
  });
    // Fun√ß√£o para atualizar o gr√°fico de pizza
    function atualizarGraficoPizza() {
      const periodo = document.getElementById('periodoSelect').value;
      graficoPizza.data.labels = gerarLabelsPizza(periodo);
      graficoPizza.data.datasets[0].data = dadosChuva[periodo];
      graficoPizza.update();
    }
    const menuToggle = document.getElementById('menu-toggle');
  const sidebar = document.querySelector('.sidebar');
  const mainContent = document.querySelector('.main');

  menuToggle.addEventListener('click', () => {
      sidebar.classList.toggle('active');
      mainContent.classList.toggle('shifted');
  });
  </script>